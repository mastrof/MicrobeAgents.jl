<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D Random walk and motile patterns · MicrobeAgents.jl</title><meta name="title" content="2D Random walk and motile patterns · MicrobeAgents.jl"/><meta property="og:title" content="2D Random walk and motile patterns · MicrobeAgents.jl"/><meta property="twitter:title" content="2D Random walk and motile patterns · MicrobeAgents.jl"/><meta name="description" content="Documentation for MicrobeAgents.jl."/><meta property="og:description" content="Documentation for MicrobeAgents.jl."/><meta property="twitter:description" content="Documentation for MicrobeAgents.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">MicrobeAgents.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../introduction/">Introduction</a></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Random walks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../1_randomwalk1D/">1D Random walk</a></li><li class="is-active"><a class="tocitem" href>2D Random walk and motile patterns</a></li><li><a class="tocitem" href="../3_randomwalk3D/">3D Random walk</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Chemotaxis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Chemotaxis/1_linear_ramp/">Linear concentration ramp</a></li><li><a class="tocitem" href="../../Chemotaxis/2_celani_gauss2D/">Noisy chemotaxis towards Gaussian source</a></li><li><a class="tocitem" href="../../Chemotaxis/3_xie_response-function/">Response function (Xie)</a></li><li><a class="tocitem" href="../../Chemotaxis/4_response_functions/">Comparison of chemotactic response functions</a></li><li><a class="tocitem" href="../../Chemotaxis/5_drift_exponential/">Chemotactic drift in exponential ramp with noisy sensing</a></li></ul></li></ul></li><li><span class="tocitem">Validation</span><ul><li><a class="tocitem" href="../../../validation/msd_runtumble/">Mean squared displacement</a></li><li><a class="tocitem" href="../../../validation/run_distribution/">Run-length distribution</a></li><li><a class="tocitem" href="../../../validation/velocity_autocorrelations/">Velocity autocorrelation functions</a></li></ul></li><li><a class="tocitem" href="../../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Random walks</a></li><li class="is-active"><a href>2D Random walk and motile patterns</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D Random walk and motile patterns</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mastrof/MicrobeAgents.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mastrof/MicrobeAgents.jl/blob/main/examples/RandomWalks/2_randomwalk2D_motilepatterns.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="2D-Random-walk-and-motile-patterns"><a class="docs-heading-anchor" href="#2D-Random-walk-and-motile-patterns">2D Random walk and motile patterns</a><a id="2D-Random-walk-and-motile-patterns-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Random-walk-and-motile-patterns" title="Permalink"></a></h1><p>Here we will simulate two dimensional random walk with different motile patterns.</p><p>As usual we start by setting up the model.</p><pre><code class="language-julia hljs">using MicrobeAgents
using Distributions
using Plots

L = 500 # space size in μm
space = ContinuousSpace((L,L)) # defaults to periodic
dt = 0.1 # integration timestep in s
model = StandardABM(Microbe{2}, space, dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">StandardABM with 0 agents of type Microbe{2}
 agents container: Dict
 space: periodic continuous space with [500.0, 500.0] extent and spacing=25.0
 scheduler: fastest
 properties: chemoattractant, affect!, timestep</code></pre><p>We will now add microbes individually, choosing different properties for each. The motile pattern can be customized through the <code>motility</code> keyword.</p><p>The <code>RunTumble</code> motility consists of straight runs interspersed with isotropic reorientations (tumbles). With the first argument, we set the average duration of tumbles, 1 s in this case. We can then define the speed to follow a a <code>Normal</code> distribution (from Distributions.jl) with mean 30 μm/s and standard deviation 6 μm/s. This means that, after every tumble, the microbe will change its speed following this distribution. Further, we can set tumbles to also have a finite duration, let&#39;s say 0.1 s.</p><pre><code class="language-julia hljs">add_agent!(model; motility=RunTumble(1.0, Normal(30,6), 0.1))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Microbe{2, 2} with 2-state motility pattern
position (μm): [52.29, 33.91]; velocity (μm/s): [34.79, -6.01]
other properties: speed, rotational_diffusivity, radius, state</code></pre><p>The <code>RunReverse</code> motility consists of alternating straight runs and 180-degree reversals. This motility pattern is implemented as a 4-step motility (i.e., <code>Motility{4}</code>): a run &quot;forward&quot;, a reversal of direction, a run &quot;backward&quot;, and another reversal of direction, after which the cycle starts again. In principle, each of these 4 steps can be modified independently from the others. Here, we will set the duration and speed of the two run steps, and keep default values for reversals. Further, we set the <code>rotational_diffusivity</code> of the microbe to 0.2 rad²/s; in absence of rotational diffusion, the run reverse motility is pathologically incapable of exploring space efficiently.</p><pre><code class="language-julia hljs">add_agent!(model; motility=RunReverse(1.0, [30.0], 0.7, [20.0]), rotational_diffusivity=0.2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Microbe{2, 4} with 4-state motility pattern
position (μm): [424.13, 405.35]; velocity (μm/s): [28.4, 9.67]
other properties: speed, rotational_diffusivity, radius, state</code></pre><p>The <code>RunReverseFlick</code> motility consists of a straight run, a 180-degree reversal, then another straight run followed by a 90-degree reorientation (the flick). Like the <code>RunReverse</code>, this is a four-step motility pattern; indeed, we can imagine it as a <code>RunReverse</code> where the reorientation after the &quot;backward&quot; run is 90 instead of 180 degrees. Again, we will set only run durations and speeds. We also set the rotational diffusivity to 0.1 rad²/s.</p><pre><code class="language-julia hljs">add_agent!(model; motility=RunReverseFlick(2.0, [25.0], 0.5, [25.0]), rotational_diffusivity=0.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Microbe{2, 4} with 4-state motility pattern
position (μm): [483.17, 62.34]; velocity (μm/s): [23.18, 9.35]
other properties: speed, rotational_diffusivity, radius, state</code></pre><p>Now we can run (collecting the microbe positions at each timestep), unfold the trajectories, and visualize them.</p><pre><code class="language-julia hljs">nsteps = 600
adata = [position]
adf, _ = run!(model, nsteps; adata)

Analysis.unfold!(adf, model)
traj = Analysis.adf_to_matrix(adf, :position_unfold)
x = first.(traj)
y = last.(traj)
t = axes(x,1) .* dt

plot(x, y, xlab=&quot;x&quot;, ylab=&quot;y&quot;, ratio=1,
    lab=[&quot;RunTumble&quot; &quot;RunReverse&quot; &quot;RunReverseFlick&quot;]
)</code></pre><img src="e1772d35.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1_randomwalk1D/">« 1D Random walk</a><a class="docs-footer-nextpage" href="../3_randomwalk3D/">3D Random walk »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 21 May 2024 09:27">Tuesday 21 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
